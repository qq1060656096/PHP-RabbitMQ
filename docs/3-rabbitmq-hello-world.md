RabbitMQ 是一个消息中间件: 它接受和转发消息。你可以看看邮局，当你要发邮件时，你会想到把邮件放到邮箱里面。可以肯定的是，快递员最终会把邮件给收件人。在这个比喻中。RabbitMQ 是邮箱、邮政局、快递员。

RabbitMQ和邮局之间的主要区别是,它不处理,相反,它接受数据,消息的存储和转发的二进制文件。

RabbitMQ和消息传递在一般情况下,使用一些术语。

生产方式发送。一个程序发送消息是一个生产者

一个队列的名称在RabbitMQ中是一个邮箱.尽管通过RabbitMQ消息流和应用程序,他们只能存储在一个队列.队列只受主机的内存和磁盘限制,它本质是一个大消息缓冲区。很多生成者可以蒋消息发送到一个队列,和许多消费者可以从一个队列接受数据。这就是我们如何描述一个队列。

消费也有类似的意义。消费者大多是一个程序,等待接收消息。

在这部分的教程中我们将用PHP编写两个程序,发送一个消息的生产者,消费者接收信息并打印出来。我们会掩盖一些细节的php-amqplib API,把精力集中在这个非常简单的事情开始。这是一个“Hello World”的消息。

在下面的图中,“P”是我们的生产和“C”是我们消费者。中间的框是一个队列,消息缓冲RabbitMQ代表消费者。

![avatar](data:image/png;base64,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)

### 1步
使用"composer"引入"php-amqplib/php-amqplib"库

```php
{
    "require": {
        "php-amqplib/php-amqplib": ">=2.6.1"
    }
}
```

安装好"php-amqplib",我们可以编写一些代码

### 2 步
>生产者

![avatar](data:image/png;base64,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)


我们叫消息发布者(sender)"send.php",消息接受者叫"receive.php".生产者蒋连接到RabbitMQ发送一条消息并退出

在"send.php"，我们必须包含必须的库和必要的类

```php
require_once __DIR__ . '/vendor/autoload.php';
use PhpAmqpLib\Connection\AMQPStreamConnection;
use PhpAmqpLib\Message\AMQPMessage;
// 创建好服务器连接后
$connection = new AMQPStreamConnection('localhost', 5672, 'guest', 'guest');

// 我们必须创建"channel"通道和声明队列名和发送消息到队列中 
$channel = $connection->channel();
$channel->queue_declare('hello', false, false, false, false);

$msg = new AMQPMessage('Hello World!');
$channel->basic_publish($msg, '', 'hello');
echo " [x] Sent 'Hello World!'\n";
// 最后关闭通道和连接
$channel->close();
$connection->close();
```

### 3步
> 接受者

![avatar](data:image/png;base64,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)



我们从RabbitMQ接受消息,不同的生成者发送消息,
我们保持运行监听消息并打印出来。

在"receive.php"，我们必须包含必须的库和必要的类


```php
require_once __DIR__ . '/vendor/autoload.php';
use PhpAmqpLib\Connection\AMQPStreamConnection;

$connection = new AMQPStreamConnection('localhost', 5672, 'guest', 'guest');
$channel = $connection->channel();

$channel->queue_declare('hello', false, false, false, false);

echo ' [*] Waiting for messages. To exit press CTRL+C', "\n";

$callback = function($msg) {
  echo " [x] Received ", $msg->body, "\n";
};

$channel->basic_consume('hello', '', false, true, false, false, $callback);

while(count($channel->callbacks)) {
    $channel->wait();
}
```

现在我们在命令行(终端)运行2个脚本

```php
php receive.php
```

```php
php send.php
```
消费者将打印消息从发送方通过RabbitMQ。接收者将继续运行,等待消息(使用ctrl - c来阻止它),所以尝试发送方从另一个终端上运行。



您可能希望看到队列RabbitMQ和有多少消息。你可以使用rabbitmqctl工具(如特权用户):

```php
# linux使用命令
sudo rabbitmqctl list_queues

# windows使用命令
rabbitmqctl.bat list_queues
```